# IOTA C Light Wallet x86-64-dev-test

A big thanks to the people of the IOTA implementation of the Ledger Nano S.
They create an amazing low footprint C light wallet implementation for the Nano S.
We use this as base for the generic embedded C light wallet implementation.

## Notice to this branch

This branch is an educational sandbox for testing IOTA transactions with C language. It may be used to prepare future porting to embedded systems. The example code in main.c provide a quick introduction to perform transactions greater than 0iota in accordance with the following arguments inputs : 
```
./c_light_wallet <SEED_81_CHARS> <SECURITY> <INDEX> <COUNT> <DEST_ADDRESS_81 _CHARS> <FUND_TO_SPEND>

As :
SEED_81_CHARS : the seed in Chars representation
SECURITY : The security level between 1 and 3.
INDEX : The lower limit index
COUNT : The upport limit index
DEST_ADDRESS_81 _CHARS : The destination address 
FUND_TO_SPEND : the number IOTA to spend.
```

The network layer use libcurl. You may need to install this library if you have not already (see instructions below).

**!! This is still in working progress. Use this with care. Do not use as is for production. You are responsible of your funds !!** 

## Installing libcurl (linux)

Download the latest release of libcurl on [libcurl website](https://curl.haxx.se/download.html)
```
tar -xzvf curl-x.xx.x.tar.gz
```
```
cd curl-x.xx.x
```
```
./configure
make
make install #you may need root privilege
```
After installation, libcurl should be located in file system at /usr/local/lib/ (lib file) and /usr/local/include/curl (source header files)

## Usage
### Branching
```
git clone https://github.com/maxmbed/iota-c-light-wallet.git
```
```
cd iota-clight-wallet
git checkout x86-64-dev-test
```
### Generated Makefile
```
cmake CMakeLists.txt
```
### Compile code
```
make
```
### Execute
```
./c_light_wallet <SEED_81_CHARS> 2 0 7 <DEST_ADDRESS_81 _CHARS> 100
```
*Do not include address checksum.*

On successful execution, several output will be shown to you : 
```
[get address][0] LGYVGHWKEMQDUJCQBJDVNFPDDCYLIMKCMUEIPFSDULXJQLPLCJVOLSBNTTVFC9ODKTPFSVGJ9ZGOYMXCC : 100i spent : 1
[get address][1] NXQJKVFIHNQA9GC9CPOQKXN9PZJA9PZCZWC9OCZ9ZFULFWRXALIAVJAALALWIQBIWKZYZRAGNZI9IEMEW : 0i spent : 0
[get address][2] OBNAFUEPMLTYSRUZAMEZOBTVSIYUXHUJDWDOTCYFKNT9VHWGNWU9PVSOBBTXHPFAOFDVRYDBGAK9IRYUW : 0i spent : 0
[get address][3] AAOWHFRYUYTHWVQPQGXSNTVJBNVTDEFHXKJHRSCZQYEVRPVNENBRQBLJPXYNFMIDDITOGJSLRCCDSFRLW : 0i spent : 0
[get address][4] LGXXDU9FDPUOLGXCHPYIEZJNLZZFCXDCM9ERDGYIMQOXDLIIYMDTKSA9DGDZDXKSKCSBEDZMLGOIM9TJW : 0i spent : 0
[get address][5] JFALOUUIRAHJNIQVZLDSNHKCIPNUELJR9HQSEGHREYAGSPTEXMOWEAYLZYKGFFGZGHZQFMQNSHDCLEHBD : 0i spent : 0
[get address][6] YFZBQNUPVKYVKFYWFANRSLGPQPPHGLHRNYGXGULOZ9LJZIZFHHLLRYSQCNXHEPXCLYMXFWHIFHYX9XXAD : 0i spent : 0


[info][destination address] : output TX : address[NXQJKVFIHNQA9GC9CPOQKXN9PZJA9PZCZWC9OCZ9ZFULFWRXALIAVJAALALWIQBIWKZYZRAGNZI9IEMEW] - value 10i
[info][remain address] : output TX : address[NXQJKVFIHNQA9GC9CPOQKXN9PZJA9PZCZWC9OCZ9ZFULFWRXALIAVJAALALWIQBIWKZYZRAGNZI9IEMEW] - value 90i
[info][spent address] : input TX : address[0] - value -100i

[info] : Bundle transaction :
	[part 0] : RWPVLFXMFHFWGHKSPTZROTBDNLBJAWQFRKXQSDSLOEUBVYBKZWZWKMVAUGNXDFEGEUHPJKHWIAJ9UDWOCYIOVEOAEKGZSSPKJRKI9LPWYNYXYLTNUBRITCCP99FCOHTGUUPXZFYQDNGAKDAZWYERJNIDHDI9PYCDGCQECPIYEPURYMFXIJHDTUPNZBNET9AQAB9VBY9KNBVWWCPIXOHYDTBHTKYRVBWSC9NMDORCMOLDQIHQ9MCSRTZNJSFA9RSDQYKAXZNRNMAJKDCOERVADNGERKGFZGRRX9VZIS9SVTXQFWTCWG9DEMCQXZPF9YNOEAIDUDDDKPUBDODEZZJVYTL9OMZVUCIYF9DES9SRCYHFTCNLO9UTMRFNRFEPMMX9OEQD9UBAIQNOMAGPPJARBKB9KGCSBJRUWOYFKLJLGTOVKFSEFGUBRHRCHELEPVRO9TKYHWRK9U9ZRELRGE9SJXBZINWMBDZOEMGXKWFRXQHHNWZKXVAEUIMEFLXUBOLJDGGTKVUREQJXLCTGFUAGYBDGSKHKBIMCZ99HKMYUUVQYQOQJIGMOD9D9BAFDPFWJMCOVJHDJMWNPRRHMPTXTQMKIKN9AGVVCXZGOZNHLMEORLXSJSI9XKKZLZMK9FHINFM9AVD9ZMGXDIOBBQORAYBDIZTTIW9C9WYUTWY9FRRLGKVWHPDRBGLHTAAOZMQTWRDIDJENPKPYMKRPXYCJLYSVUDASANNLKZAORFRFVGBYEJLGIKRVUDFBAXHBPEPUQPIYFNSGKKDDVJIBJQMBETJIPMO9GFLRANNHWP9GTRDFMLZDSXUPYTCJWFFMQPCQDMZHNSMDLFKKJUWQTNYNEUS9YJBWI9MP9OFHJFYESPFYPWANYQVGGUPSQLNWMTJLKRAQUUWKNUETMPR9HARHWWXPMNLMQQ9KJFDDZRUUBCPFWNU9XVYCIBIFVPHJFKOUEEZXHTHLLVMJZUZRJBBJ9G99ICPYJMMDWGNONFTMOCPEB99FAJLHMIPAQEZNQPKCGMTDRJQMOSUSUSVOTYZPHEIE9UO9IYRDNTFTQNGPQFGHQCQRNQUEV9EDFDBJLTPERLVNPECGWVOEIZULODQNFAPMHZ9XXQMZYDITYJJPGJFMZNWDPJNIQ9XXJIJLGOJJFJUMMSG9SNKPXRKLLY9ZKNBLMCX9LMNIGID9UHQSQKIPTGJJVXAXKC9YBNTRWBYDX9AYZYTHQNM9WCE9FOPMSEBEXJHKTNHASRWVLDLOZDZDJPROEZFMABWYWBCZLQVIZDXQKXMSIOLSSTGLDEJCXELZFRWFENBZYJCAWZVOJGWVJKHNMTRHJEOQKETSYLHDGNUXQXWKUDA9OPCREDBUQV9YUJXBGYBLSDOROMUEOHVDCYCZGAXZYWZS9TPPBEQ9HSC9YWUBEUZURKHVQZYSIZKKWKMSIWZBHTUYUARCBRBIFKSDHEAEBSCRFEYZHITDUS9GOKXKGJTHJVUFAXFHGJ9CCHI9EDMSAMDSIGLPGBZXQXQBE9BLMURT9ENW9JYFNBWAURURCDBFVTNAZEWHQGJXMRYIEXOXIHMPLQERKSTIJ9RLEXIGRLHLQPBZEP9EYYQVFDKJVGWIKHHPROUUCQGTOEWUUYBELVNFGDXRHQZJVOEFBDAZJTGXYOQ9QSZZWSBDXOXJVMCBPMVXAZPEHACUBCLDBY9SGUUJMXYPTEE9EVPMYLDAZXM9NX9MCX9BSBYZMNWAOKYKFIKFYJMNCRVNKEZHQVDYGJGDDJCLBKS9OYIDHMIMKZDLNGKHRONEI9XSVTMQAM9A9AQMURMWBAPRMRLRDXYZDGBZHMQRGMDNPB9FUTIRZSPSOIRJABJHVZRTCOBXGXXBYEZIKGSWQRCLQXPXQNYBIITPGOVIDJXMUWUKEPDLBRBZHNRJWRTHVD9AERZJMFVXBUDSCFETLWETDSRJ99F9WSWZFCH9RMEQUQYOWQQOLMTPKPMNLEWMGEFXUZNNOJXYNLZQWCOSKTCNJUGMNDWVJFDTJJQR9YRSMUK9YXYBCNLQRCVBOWTW9WVQIX9DGZPORBOLBKMHEYNLUGEXXJJNDYYBOVPST9PYTJRQUKTLKCC9DBDZLAQBH9LQUCPRRLD9HOSKHOZWMCEFFNGCDIDNJLYSCAWKCHLSTEUNIQPWYIDAQJAIRJSEYVGVZFTNGIVBLGYVGHWKEMQDUJCQBJDVNFPDDCYLIMKCMUEIPFSDULXJQLPLCJVOLSBNTTVFC9ODKTPFSVGJ9ZGOYMXCC999999999999999999999999999999999999999999999999999999QYTGPZD99C99999999C99999999W9ULLULEEAIJYCVNEASTWBDREEAXKMTRQHEUFREXFILHZGJJXS9DRAIBJQKZGSJZZOQL9FSYJZEDUYPHB999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
	[part 1] : YOJKCTBVCVXOP9WGYYBFUXBIIQHJMYJJKCGDZGQKVJGVKJYBDASIGONROZDWIFBN9WJQCQUQNEWOUOH9CEZLSPCXMGISHLLYLBA9DLFLKHCSPRNTOJAAEAZZVTSKMJLCKTHBTAQEH9CWKDQEVYOCEAP9JPR9XFSHEBURO9ZTATLYRZD9JXFICHIHERHTCFPXG9LEDLODELJVKMQBQWLJKPVWCQWCSJADZLGFRGOGCJXMOEEJZQDQFTOTCFOWGYFIRUREIAOE9OBQCVVRWYDEV9GLRGBWJEJBWBEOTCAJDEZOSMLHSSLYQZOXHPZODPTJVKOZTNORBWATJVX9DCYJAZUPYPIZSBVHCCYRUPPUMJBHA9NWVSZ9XEDFRB9EJAAMAICQSNOLMEGLVGCMHPUUXG9BCVWWVQE9O9LFSDTQKH9FF9RIYUHRBNNBDVVSNLTJYLW9GNBMEJRZUYYYRGKRGHCWQBYXMRWWBX9JLD9PQHSRNEKG9BBBFPTNCQONCZSYJVE9HNKANPWWX9CAXIR9QDI9BWZYNWISBXRQRRFNUAMJRCOBTKECVM9L9JEKALRXDATCWPWCMVHSHOGZYGFKPHJSXQBHCUWMMZBXOVAANKTIYXKBQOXLWI9OJSTJVBHUBJUSPBMDTIMSBZ9CVYMQZKMBBCEN9SUBIBGINNMNRCFRPOUQQQHQEJYMAXNQZ9OBIKIKVLBUIRKPXXRJRMGVEYOOATXVNMNXAG9OABJIAYACSRUNPGJSDXADIXMTIRZFZHBQLFFYCCLSULLRRXMXXKJBGPGQNHLQGWDRUBWPR9DKAMXPAZZDGCTBEUVQSCAEYQQCPHBDKBKCDHXDBGNGACZQFDTTHHMZEPOGENXNEFHCIPIFUPNKTMMWLVWLIQHBAQZDSCYURFRLUHNFFKKBSW99LHQSFTUJRTPCGQQHEBTFACZNAYJQFZLIPSHXBQTSHMG9HOXXWEBXCVAGZMJXCLVDANYHNKWGY9OTYI9QSGDKHUGPOTOSTYSLQPCLDDFKNKKIGOEPHOU9KDBCMAMMQFNLKCGUXMIZABHSBZCHPCAQ99LTZOMNTVZRU9FPEO9BCMSSQUTVD9UPIHYTYXODBYUOCNKYPFLCUCERSXADRTNTODCALOJBNMFRZPQQVAG9MTRJAHAGGTXITQYJBBWKFQGF9FOBRDSBQHRVHMPDGDKQ9YHZNQSOUYOHXIPA9M9YHQOGLIDNSMFDTKYNOUMUWHACSLGDIIOONLTEYBTXYFNRSJFLYUGXODOEUXGJBBCDMJP99GABMLLEBQIXWSJRWLWHVMGWKHXWJJLPKXOVKOBKHDRULYSDVJX9XFOSHIAOATPKBJJWHAPNJIDHZDO9FNJCGGL9DISNBXZILPQBSPZGFVWHPFQLULSOGKA9LLHLNIDXDIUVCSNVDVMA9AFT9TNHYRGGQCUVBHU9CGITBQHZFULTOYCPEQLIEVOKYXQOPDRWJEROUGVGXT9VXIAGCTTMZCJKKZFKKGZDSNCJRYODQGWTASLVHZRQEQPNUIOPAUABHPS9AZBZPXHNCBAGMXYAGNAFIIMGCOBOKFBX9ZNUXJHTIZQMEINCZD9W9PLPCMOAVTKUAVVQQOVUEBFYZKPGFQXCFCKPELJPMCOMWCBM9MAZD9ONLAKNROUKRZVFCXRANQJHOXSDBKTWSZLDBGYZDZRKKHXGHVXADRORNMNJWICLPSTDNSRPCZVCHZGCMPUOGIGOVNLDBXZYLWGGAKBPETHPMOHBBRQEDOGDWDFTPVRLWWUVG9NXJTXBLEBPCTTWAEVNFVBVJGAZUAHY9XONOUPTSSLHSUBL9AXZPYHEG9MRTRBPQCPCPSO9DKWBVOQOCSAMNEODJOZZNLEIFPQRFYU9LTLGABKCYUEXNXHRJZVQNJ9THENXYYCZONHJDLEUNCUTWDGQKPSLZKXQMBQZDKBKWWPNZNOFCQLFLKIKVBXARFZMMUQBNLEFBWP9JOOCAKWJWJEQVOUNVWATOKPLCFCW9IUXBGQWUIERXTADUGCWTXPIP9UTYBQFKSVKODALSDZFSLQCXQWVDYKHRFPKYEBQIZMCBQK9OAOEKIXSSIFAHOEOVPSSKAFGPXASKBFRRCP9LXBYJFVW9LSFEIQVIHJCNAISGTZCNWTCURTOPZJBHCSKKVHUHGPOJFRXQLLCGAMKMK9LGYVGHWKEMQDUJCQBJDVNFPDDCYLIMKCMUEIPFSDULXJQLPLCJVOLSBNTTVFC9ODKTPFSVGJ9ZGOYMXCCHW9999999999999999999999999999999999999999999999999999QYTGPZD99B99999999C99999999W9ULLULEEAIJYCVNEASTWBDREEAXKMTRQHEUFREXFILHZGJJXS9DRAIBJQKZGSJZZOQL9FSYJZEDUYPHB999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
	[part 2] : 999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999NXQJKVFIHNQA9GC9CPOQKXN9PZJA9PZCZWC9OCZ9ZFULFWRXALIAVJAALALWIQBIWKZYZRAGNZI9IEMEWIC9999999999999999999999999999999999999999999999999999QYTGPZD99A99999999C99999999W9ULLULEEAIJYCVNEASTWBDREEAXKMTRQHEUFREXFILHZGJJXS9DRAIBJQKZGSJZZOQL9FSYJZEDUYPHB999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999
	[part 3] : HELLO9WORLD9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999NXQJKVFIHNQA9GC9CPOQKXN9PZJA9PZCZWC9OCZ9ZFULFWRXALIAVJAALALWIQBIWKZYZRAGNZI9IEMEWJ99999999999999999999999999HQCEDDED9999999999999999999QYTGPZD99999999999C99999999W9ULLULEEAIJYCVNEASTWBDREEAXKMTRQHEUFREXFILHZGJJXS9DRAIBJQKZGSJZZOQL9FSYJZEDUYPHB999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999HQCEDDED9999999999999999999999999999999999999999999999999999999999999999999999999
```

### Define full node 
Node addresses and ports can be define in src/iota/iota_api.h

## A notice to trytes:

Due to confusion of several people, a short explanation about the conversions.
The API for the conversion is available in conversion.c and conversion.h.

In this context the following words have the following meaning:

**Chars:** Means the char representation of an Tryte. (ASCII character) A - Z and 9.  (base-27 encoded ternary number)
**Bytes:** Means a byte representation of trytes, optimized for low storage and memory usage.  
**Trits:** Means a int8_t array representation of trits.   
**Trytes:** Means a int8_t array representation of trytes.

### Conversion space ratio

One transaction = 2673 trytes = ((2673/81) * 48) Bytes = 2673*3 Trits = 2673 chars


## General Usage:
### Generation of addresses


```
 unsigned char address[81];
 char seedChars[] = "INSERT_SEED_HERE";
 unsigned char seedBytes[48];
 chars_to_bytes(seedChars, seedBytes, 81);
 get_public_addr(seedBytes, 0, 2, address);

 char charAddress[81];
 bytes_to_chars(address, charAddress, 48);
```

### Generation of transactions and bundles

```
char *seed = "YOURSEEDSTRING"; // 81 ternary characters
char address_one[82] = {0};
char address_two[82] = {0};
char *tag = "ANTAG"; //27 ternary characters

//Define the output array, where the coins must go to.
TX_OUTPUT output_txs[] = 
    {{.address = "ANADDRESS", .value = 10000, .message = "", .tag = ""}}; //ANADDRESS => 81 ternary characters


//Define the input array. Where the coins come from
TX_INPUT input_txs[] = {{.key_index = 4, .balance = 10000}};

//Define the transaction chars array. The char trytes will saved in this array. (base-27 encoded)
char transaction_chars[10][2673];
//Get all raw transaction trytes. Will saved in transaction_chars
prepare_transfers(seed, 2, output_txs, 1, input_txs, 1, transaction_chars);

```




